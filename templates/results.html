{% extends 'layout.html' %}
{% block content %}
<h2>Manage Results</h2>

<div class="card-form">
    <h3>Add Result</h3>
    <form action="{{ url_for('results') }}" method="POST">
        <div class="form-row">
            <div class="form-group">
                <label>Roll No</label>
                <input type="text" name="roll_no" required placeholder="Enter Roll No">
            </div>
            <div class="form-group">
                <label>Marks Obtained</label>
                <input type="number" name="marks_ob" required placeholder="Marks Obtained">
            </div>
            <div class="form-group">
                <label>Full Marks</label>
                <input type="number" name="full_marks" required placeholder="Full Marks">
            </div>
        </div>

        <button type="submit" name="add" class="btn btn-primary">Add Result</button>
        <button type="submit" name="delete" class="btn btn-danger" onclick="return confirm('Are you sure?')">Delete (Use
            ID)</button>
    </form>
</div>

<div class="table-container">
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Roll No</th>
                <th>Name</th>
                <th>Course</th>
                <th>Marks Obtained</th>
                <th>Full Marks</th>
                <th>Percentage</th>
            </tr>
        </thead>
        <tbody>
            {% for result in results %}
            <tr>
                <td>{{ result[0] }}</td>
                <td>{{ result[1] }}</td>
                <td>{{ result[2] }}</td>
                <td>{{ result[3] }}</td>
                <td>{{ result[4] }}</td>
                <td>{{ result[5] }}</td>
                <td>{{ result[6] }}%</td>
            </tr>
            {% endfor %}
            {% if not results %}
            <tr>
                <td colspan="7">No results found.</td>
            </tr>
            {% endif %}
        </tbody>
    </table>
</div>

<script>
    const table = document.querySelector('table');
    table.addEventListener('click', (e) => {
        const row = e.target.closest('tr');
        if (row && row.children.length > 1) {
            document.querySelector("input[name='roll_no']").value = row.children[1].innerText;
            // Mark details might vary, so just roll no is safe to initiate
        }
    });
</script>
{% endblock %}